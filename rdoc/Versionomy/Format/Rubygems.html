<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>module Versionomy::Format::Rubygems - Versionomy 0.5.0 Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
</script>

<script src="../../js/jquery.js"></script>
<script src="../../js/darkfish.js"></script>

<link href="../../css/fonts.css" rel="stylesheet">
<link href="../../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="module">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../table_of_contents.html#pages">Pages</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    
    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-create">::create</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="module-Versionomy::Format::Rubygems">
  <h1 id="module-Versionomy::Format::Rubygems" class="module">
    module Versionomy::Format::Rubygems
  </h1>

  <section class="description">
    
<p>This is a namespace for the implementation of the <a
href="Rubygems.html">Rubygems</a> schema and format.</p>

  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-create" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">create</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Create the rubygems format. This method is called internally when <a
href="../../Versionomy.html">Versionomy</a> loads the rubygems format, and
you should not need to call it again. It is documented so that you can
inspect its source code from RDoc, since the source contains useful
examples of how to use the schema and format definition DSLs.</p>
          
          

          
          <div class="method-source-code" id="create-source">
            <pre><span class="ruby-comment"># File lib/versionomy/format_definitions/rubygems.rb, line 122</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">create</span>

  <span class="ruby-comment"># The following is the definition of the rubygems schema</span>
  <span class="ruby-identifier">schema_</span> = <span class="ruby-constant">Schema</span>.<span class="ruby-identifier">create</span> <span class="ruby-keyword">do</span>

    <span class="ruby-comment"># Global comparison function</span>
    <span class="ruby-identifier">to_compare_type</span>(<span class="ruby-value">:string</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">a_</span>, <span class="ruby-identifier">b_</span><span class="ruby-operator">|</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">a_</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-operator">::</span><span class="ruby-constant">Integer</span>)
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">b_</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-operator">::</span><span class="ruby-constant">Integer</span>)
          <span class="ruby-identifier">a_</span> <span class="ruby-operator">&lt;=&gt;</span> <span class="ruby-identifier">b_</span>
        <span class="ruby-keyword">else</span>
          <span class="ruby-value">1</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">b_</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-operator">::</span><span class="ruby-constant">Integer</span>)
          <span class="ruby-value">-1</span>
        <span class="ruby-keyword">else</span>
          <span class="ruby-identifier">a_</span> <span class="ruby-operator">&lt;=&gt;</span> <span class="ruby-identifier">b_</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># Global canonicalization function</span>
    <span class="ruby-identifier">to_canonicalize_type</span>(<span class="ruby-value">:string</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">val_</span><span class="ruby-operator">|</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">val_</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-operator">::</span><span class="ruby-constant">Integer</span>)
        <span class="ruby-identifier">val_</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">val_</span> = <span class="ruby-identifier">val_</span>.<span class="ruby-identifier">to_s</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">val_</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/\A\d*\z/</span>
          <span class="ruby-identifier">val_</span>.<span class="ruby-identifier">to_i</span>
        <span class="ruby-keyword">else</span>
          <span class="ruby-identifier">val_</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># The first field has the default value of 1. All other fields</span>
    <span class="ruby-comment"># have a default value of 0. Thus, the default version number</span>
    <span class="ruby-comment"># overall is &quot;1.0&quot;.</span>
    <span class="ruby-identifier">field</span>(<span class="ruby-value">:field0</span>, <span class="ruby-value">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:integer</span>, <span class="ruby-value">:default_value</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">field</span>(<span class="ruby-value">:field1</span>, <span class="ruby-value">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:string</span>) <span class="ruby-keyword">do</span>
        <span class="ruby-identifier">field</span>(<span class="ruby-value">:field2</span>, <span class="ruby-value">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:string</span>) <span class="ruby-keyword">do</span>
          <span class="ruby-identifier">field</span>(<span class="ruby-value">:field3</span>, <span class="ruby-value">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:string</span>) <span class="ruby-keyword">do</span>
            <span class="ruby-identifier">field</span>(<span class="ruby-value">:field4</span>, <span class="ruby-value">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:string</span>) <span class="ruby-keyword">do</span>
              <span class="ruby-identifier">field</span>(<span class="ruby-value">:field5</span>, <span class="ruby-value">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:string</span>) <span class="ruby-keyword">do</span>
                <span class="ruby-identifier">field</span>(<span class="ruby-value">:field6</span>, <span class="ruby-value">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:string</span>) <span class="ruby-keyword">do</span>
                  <span class="ruby-identifier">field</span>(<span class="ruby-value">:field7</span>, <span class="ruby-value">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:string</span>)
                <span class="ruby-keyword">end</span>
              <span class="ruby-keyword">end</span>
            <span class="ruby-keyword">end</span>
          <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># Some field aliases providing alternate names for major fields</span>
    <span class="ruby-identifier">alias_field</span>(<span class="ruby-value">:major</span>, <span class="ruby-value">:field0</span>)
    <span class="ruby-identifier">alias_field</span>(<span class="ruby-value">:minor</span>, <span class="ruby-value">:field1</span>)

    <span class="ruby-comment"># Add the methods in this module to each value</span>
    <span class="ruby-identifier">add_module</span>(<span class="ruby-constant">Format</span><span class="ruby-operator">::</span><span class="ruby-constant">Rubygems</span><span class="ruby-operator">::</span><span class="ruby-constant">ExtraMethods</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># The following is the definition of the rubygems format. It</span>
  <span class="ruby-comment"># understands the rubygems schema defined above.</span>
  <span class="ruby-constant">Format</span><span class="ruby-operator">::</span><span class="ruby-constant">Delimiter</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">schema_</span>) <span class="ruby-keyword">do</span>

    <span class="ruby-comment"># All version number strings must start with the major version.</span>
    <span class="ruby-comment"># Unlike other fields, it is not preceded by any delimiter.</span>
    <span class="ruby-identifier">field</span>(<span class="ruby-value">:field0</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">recognize_number</span>(<span class="ruby-value">:delimiter_regexp</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;&#39;</span>, <span class="ruby-value">:default_delimiter</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;&#39;</span>)
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># The remainder of the version number are represented as strings</span>
    <span class="ruby-comment"># or integers delimited by periods by default. Each is also</span>
    <span class="ruby-comment"># dependent on the presence of the previous field, so</span>
    <span class="ruby-comment"># :requires_previous_field retains its default value of true.</span>
    <span class="ruby-comment"># Finally, they can be optional in an unparsed string if they are</span>
    <span class="ruby-comment"># set to the default value of 0.</span>
    <span class="ruby-identifier">field</span>(<span class="ruby-value">:field1</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">recognize_regexp</span>(<span class="ruby-string">&#39;[0-9a-zA-Z]+&#39;</span>, <span class="ruby-value">:default_value_optional</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">field</span>(<span class="ruby-value">:field2</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">recognize_regexp</span>(<span class="ruby-string">&#39;[0-9a-zA-Z]+&#39;</span>, <span class="ruby-value">:default_value_optional</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">field</span>(<span class="ruby-value">:field3</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">recognize_regexp</span>(<span class="ruby-string">&#39;[0-9a-zA-Z]+&#39;</span>, <span class="ruby-value">:default_value_optional</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">field</span>(<span class="ruby-value">:field4</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">recognize_regexp</span>(<span class="ruby-string">&#39;[0-9a-zA-Z]+&#39;</span>, <span class="ruby-value">:default_value_optional</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">field</span>(<span class="ruby-value">:field5</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">recognize_regexp</span>(<span class="ruby-string">&#39;[0-9a-zA-Z]+&#39;</span>, <span class="ruby-value">:default_value_optional</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">field</span>(<span class="ruby-value">:field6</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">recognize_regexp</span>(<span class="ruby-string">&#39;[0-9a-zA-Z]+&#39;</span>, <span class="ruby-value">:default_value_optional</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">field</span>(<span class="ruby-value">:field7</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">recognize_regexp</span>(<span class="ruby-string">&#39;[0-9a-zA-Z]+&#39;</span>, <span class="ruby-value">:default_value_optional</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>)
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># By default, we require that at least the first two fields</span>
    <span class="ruby-comment"># appear in an unparsed version string.</span>
    <span class="ruby-identifier">default_unparse_params</span>(<span class="ruby-value">:required_fields</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value">:field1</span>])
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://docs.seattlerb.org/rdoc/">RDoc</a> 4.2.1.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

