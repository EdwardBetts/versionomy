<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>module Versionomy::Conversion::Semver - Versionomy 0.5.0 Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
</script>

<script src="../../js/jquery.js"></script>
<script src="../../js/darkfish.js"></script>

<link href="../../css/fonts.css" rel="stylesheet">
<link href="../../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="module">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../table_of_contents.html#pages">Pages</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    
    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-create_semver_to_standard">::create_semver_to_standard</a>
    
    <li ><a href="#method-c-create_standard_to_semver">::create_standard_to_semver</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="module-Versionomy::Conversion::Semver">
  <h1 id="module-Versionomy::Conversion::Semver" class="module">
    module Versionomy::Conversion::Semver
  </h1>

  <section class="description">
    
<p>This is a namespace for the implementation of the conversion between the
semver and standard formats.</p>

  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-create_semver_to_standard" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">create_semver_to_standard</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Create the conversion from semver to standard format. This method is called
internally when <a href="../../Versionomy.html">Versionomy</a> loads the
semver format, and you should not need to call it again. It is documented
so that you can inspect its source code from RDoc, since the source
contains useful examples of how to use the conversion DSLs.</p>
          
          

          
          <div class="method-source-code" id="create_semver_to_standard-source">
            <pre><span class="ruby-comment"># File lib/versionomy/format_definitions/semver.rb, line 243</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">create_semver_to_standard</span>

  <span class="ruby-comment"># We&#39;ll use a parsing conversion.</span>
  <span class="ruby-constant">Conversion</span><span class="ruby-operator">::</span><span class="ruby-constant">Parsing</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword">do</span>

    <span class="ruby-comment"># Handle the case where the semver version ends with a string</span>
    <span class="ruby-comment"># field, e.g. &quot;1.0b&quot;. We want to treat this like &quot;1.0b0&quot; rather</span>
    <span class="ruby-comment"># than &quot;1.0-2&quot; since the semver semantic states that this is a</span>
    <span class="ruby-comment"># prerelease version. So we add 0 to the end of the parsed string</span>
    <span class="ruby-comment"># if it ends in a letter.</span>
    <span class="ruby-identifier">to_modify_string</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">str_</span>, <span class="ruby-identifier">convert_params_</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">str_</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/([[:alpha:]])\z/</span>, <span class="ruby-string">&#39;\10&#39;</span>)
    <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">end</span>

<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-create_standard_to_semver" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">create_standard_to_semver</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Create the conversion from standard to semver format. This method is called
internally when <a href="../../Versionomy.html">Versionomy</a> loads the
semver format, and you should not need to call it again. It is documented
so that you can inspect its source code from RDoc, since the source
contains useful examples of how to use the conversion DSLs.</p>
          
          

          
          <div class="method-source-code" id="create_standard_to_semver-source">
            <pre><span class="ruby-comment"># File lib/versionomy/format_definitions/semver.rb, line 186</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">create_standard_to_semver</span>

  <span class="ruby-comment"># We&#39;ll use a parsing conversion.</span>
  <span class="ruby-constant">Conversion</span><span class="ruby-operator">::</span><span class="ruby-constant">Parsing</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword">do</span>

    <span class="ruby-comment"># Sanity check the original value and make sure it doesn&#39;t</span>
    <span class="ruby-comment"># include fields that we don&#39;t support.</span>
    <span class="ruby-identifier">to_modify_original_value</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">value_</span>, <span class="ruby-identifier">convert_params_</span><span class="ruby-operator">|</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">value_</span>.<span class="ruby-identifier">has_field?</span>(<span class="ruby-value">:patchlevel</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">value_</span>.<span class="ruby-identifier">patchlevel</span> <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>
        <span class="ruby-identifier">raise</span> <span class="ruby-constant">Errors</span><span class="ruby-operator">::</span><span class="ruby-constant">ConversionError</span>, <span class="ruby-string">&#39;Cannot convert a version with a patchlevel to semver&#39;</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">value_</span>.<span class="ruby-identifier">tiny2</span> <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>
        <span class="ruby-identifier">raise</span> <span class="ruby-constant">Errors</span><span class="ruby-operator">::</span><span class="ruby-constant">ConversionError</span>, <span class="ruby-string">&#39;Cannot convert a version more than three fields to semver&#39;</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">value_</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># We&#39;re going to modify how the standard format version is</span>
    <span class="ruby-comment"># unparsed, so the semver format will have a better chance</span>
    <span class="ruby-comment"># of parsing it.</span>
    <span class="ruby-identifier">to_modify_unparse_params</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">params_</span>, <span class="ruby-identifier">convert_params_</span><span class="ruby-operator">|</span>

      <span class="ruby-comment"># All three fields are required</span>
      <span class="ruby-identifier">params_</span>[<span class="ruby-value">:minor_required</span>] = <span class="ruby-keyword">true</span>
      <span class="ruby-identifier">params_</span>[<span class="ruby-value">:tiny_required</span>] = <span class="ruby-keyword">true</span>

      <span class="ruby-comment"># If the standard format version has a prerelease notation,</span>
      <span class="ruby-comment"># make sure it isn&#39;t set off using a delimiter.</span>
      <span class="ruby-identifier">params_</span>[<span class="ruby-value">:release_type_delim</span>] = <span class="ruby-string">&#39;&#39;</span>
      <span class="ruby-identifier">params_</span>[<span class="ruby-value">:development_version_delim</span>] = <span class="ruby-string">&#39;&#39;</span>
      <span class="ruby-identifier">params_</span>[<span class="ruby-value">:development_minor_delim</span>] = <span class="ruby-string">&#39;-&#39;</span>
      <span class="ruby-identifier">params_</span>[<span class="ruby-value">:alpha_version_delim</span>] = <span class="ruby-string">&#39;&#39;</span>
      <span class="ruby-identifier">params_</span>[<span class="ruby-value">:alpha_minor_delim</span>] = <span class="ruby-string">&#39;-&#39;</span>
      <span class="ruby-identifier">params_</span>[<span class="ruby-value">:beta_version_delim</span>] = <span class="ruby-string">&#39;&#39;</span>
      <span class="ruby-identifier">params_</span>[<span class="ruby-value">:beta_minor_delim</span>] = <span class="ruby-string">&#39;-&#39;</span>
      <span class="ruby-identifier">params_</span>[<span class="ruby-value">:release_candidate_version_delim</span>] = <span class="ruby-string">&#39;&#39;</span>
      <span class="ruby-identifier">params_</span>[<span class="ruby-value">:release_candidate_minor_delim</span>] = <span class="ruby-string">&#39;-&#39;</span>
      <span class="ruby-identifier">params_</span>[<span class="ruby-value">:preview_version_delim</span>] = <span class="ruby-string">&#39;&#39;</span>
      <span class="ruby-identifier">params_</span>[<span class="ruby-value">:preview_minor_delim</span>] = <span class="ruby-string">&#39;-&#39;</span>

      <span class="ruby-comment"># If the standard format version includes a &quot;v&quot; prefix, strip it</span>
      <span class="ruby-identifier">params_</span>[<span class="ruby-value">:major_delim</span>] = <span class="ruby-keyword">nil</span>

      <span class="ruby-identifier">params_</span>
    <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">end</span>

<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://docs.seattlerb.org/rdoc/">RDoc</a> 4.2.1.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

